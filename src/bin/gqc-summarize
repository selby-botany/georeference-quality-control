#!/usr/bin/perl

use strict;
use warnings;

my %errors;
while (<STDIN>) {
    chomp;
    next if m/^\s*#/;
    next unless m/^\s*(?:\[ERROR\]\s+)SN-(\d+):\s*(.*)$/;
    my ($selbyNumber, $errmsg) = ($1, $2);
    push @{$errors{$errmsg}}, $selbyNumber;
}

my %errcounts;
foreach my $err (sort(keys %errors)) {
    $errcounts{$err} = (scalar @{$errors{$err}});
}

my @es = sort { $errors{$a} <=> $errors{$b} } keys(%errors);
my @ms = sort { $errcounts{$b} <=> $errcounts{$a} } keys(%errcounts);
foreach my $err (@ms) {
    print "Error: «$err» (N=$errcounts{$err}); SelbyNumbers: " .
          join(', ',@{$errors{$err}}) . 
          "\n";
}
